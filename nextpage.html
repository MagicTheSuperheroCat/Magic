<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Magic Universe</title>
  <link href="https://fonts.googleapis.com/css2?family=Mystery+Quest&display=swap" rel="stylesheet">
  <style>
    :root { --gold: #ffffaa; }
    html, body {
      margin: 0;
      height: 100%;
      background: black;
      font-family: 'Mystery Quest', cursive;
      color: var(--gold);
      overflow: hidden;
    }

    /* üåå Sternenhimmel immer im Hintergrund, nicht skaliert (kein DPR) */
    #starCanvas {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      display: block;
    }

    /* üñ•Ô∏è Desktop-Button (unten mittig, √ºber Canvas) */
    #beginButtonDesktop {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      padding: 16px 32px;
      font-size: 24px;
      color: black;
      background: linear-gradient(90deg, #ffffaa, #ffffcc);
      border: none;
      border-radius: 12px;
      box-shadow: 0 0 10px #ffffaa, 0 0 25px #ffffaa;
      cursor: pointer;
      opacity: 0; /* erscheint, wenn Text rechts eingeblendet ist */
      transition: opacity 1s ease, transform 0.3s ease;
      z-index: 10;
    }
    #beginButtonDesktop:hover {
      transform: translateX(-50%) scale(1.05);
      box-shadow: 0 0 20px #ffffaa, 0 0 40px #ffffaa;
    }

    /* üì± Mobile-Stack: Katze ‚Üí Text ‚Üí Button (zentriert, √ºber Canvas) */
    .mobile-stack {
      position: relative;
      z-index: 5;
      width: 100%;
      height: 100vh;
      box-sizing: border-box;
      padding: 24px 20px;
      display: none;              /* per Media Query ein */
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      gap: 12px;
    }
    .mobile-cat {
      width: 56vw;
      max-width: 300px;
      height: auto;
      filter: drop-shadow(0 0 10px rgba(255,255,170,0.6));
    }
    .mobile-title {
      font-size: 34px;
      margin-top: 6px;
      text-shadow: 0 0 6px rgba(255,255,170,0.6);
    }
    .mobile-line {
      font-size: 18px;
      line-height: 1.4;
      margin: 2px 0;
      max-width: 340px;
      text-shadow: 0 0 4px rgba(255,255,170,0.5);
    }
    .mobile-button {
      font-size: 20px;
      padding: 12px 22px;
      margin-top: 8px;
      color: black;
      background: linear-gradient(90deg, #ffffaa, #ffffcc);
      border: none;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(255,255,170,0.7);
      cursor: pointer;
    }
    .mobile-button:active { transform: scale(0.98); }

    /* üì± Mobile-Umschaltung */
    @media (max-width: 768px) {
      #beginButtonDesktop { display: none; }  /* Desktop-Button aus */
      .mobile-stack { display: flex; }        /* Stack ein */
    }
  </style>
</head>
<body>
  <!-- üåå Sternenhimmel -->
  <canvas id="starCanvas"></canvas>

  <!-- üñ•Ô∏è Desktop-Button -->
  <button id="beginButtonDesktop">The Beginning</button>

  <!-- üì± Mobile: Katze ‚Üí Text ‚Üí Button -->
  <div class="mobile-stack" id="mobileStack">
    <img src="images/cat_on_broom.png" alt="Magic on broom" class="mobile-cat">
    <div class="mobile-title">MEET MAGIC</div>
    <div class="mobile-line">The mystical black cat</div>
    <div class="mobile-line">who guides seekers to extraordinary gains.</div>
    <div class="mobile-line">Hold Magic, and magic will find you.</div>
    <button class="mobile-button" id="beginButtonMobile">The Beginning</button>
  </div>

  <script>
    /* ========= Sternenhimmel: nicht skaliert (kein DPR) ========= */
    const canvas = document.getElementById('starCanvas');
    const ctx = canvas.getContext('2d');

    function resizeCanvasSimple() {
      // Keine devicePixelRatio-Skalierung ‚Äì genau deine Vorgabe
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resizeCanvasSimple();
    window.addEventListener('resize', resizeCanvasSimple);

    let particles = JSON.parse(localStorage.getItem('particles')) || [];
    if (particles.length === 0) {
      for (let i = 0; i < 300; i++) {
        particles.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          size: Math.random() * 2 + 1
        });
      }
      // optional: localStorage.setItem('particles', JSON.stringify(particles));
    }

    function drawStars() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particles.forEach(p => {
        const opacity = 0.5 + Math.random() * 0.5;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, 2 * Math.PI);
        ctx.fillStyle = `rgba(255, 255, 200, ${opacity})`;
        ctx.fill();
      });
      requestAnimationFrame(drawStars);
    }
    drawStars();

    /* ========= Desktop-Animation (Katze + Canvas-Text) ========= */
    const isMobile = window.matchMedia('(max-width: 768px)').matches;
    const centerX = () => canvas.width / 2;
    const centerY = () => canvas.height / 2;

    const beginButtonDesktop = document.getElementById('beginButtonDesktop');
    const beginButtonMobile  = document.getElementById('beginButtonMobile');

    function goToBeginning() { window.location.href = 'beginning.html'; }
    beginButtonDesktop.addEventListener('click', goToBeginning);
    beginButtonMobile.addEventListener('click', goToBeginning);

    if (!isMobile) {
      const catImg = new Image();
      catImg.src = 'images/cat_on_broom.png';

      let angle = Math.PI / 4;
      let radius = Math.min(canvas.width, canvas.height) * 0.6;
      let scale = 0.02;
      const maxScale = 0.25;
      let reachedCenter = false;
      let showText = false;
      let textOpacity = 0;
      let floatAngle = 0;

      function animateDesktop() {
        // Katze bewegt sich √ºber die Sterne (kein Clear, Sterne werden separat gezeichnet)
        const shiftedCenterX = centerX() - 150;
        const shiftedCenterY = centerY();

        let catX, catY;
        if (!reachedCenter) {
          catX = shiftedCenterX + radius * Math.cos(angle);
          catY = shiftedCenterY + radius * Math.sin(angle);
          angle += 0.04;

          if (angle >= Math.PI / 4 + Math.PI) {
            radius -= 6;
            if (radius <= 2) {
              reachedCenter = true;
              showText = true;
            }
          }
          scale = Math.min(maxScale, scale + 0.002);
        } else {
          catX = shiftedCenterX;
          catY = shiftedCenterY + Math.sin(floatAngle) * 5;
          floatAngle += 0.05;
        }

        if (catImg.complete) {
          ctx.save();
          ctx.filter = 'drop-shadow(0 0 15px rgba(255, 255, 150, 0.8))';
          ctx.drawImage(
            catImg,
            catX - (catImg.width * scale) / 2,
            catY - (catImg.height * scale) / 2,
            catImg.width * scale,
            catImg.height * scale
          );
          ctx.restore();
        }

        if (showText) {
          if (textOpacity < 1) textOpacity += 0.08;

          ctx.save();
          ctx.globalAlpha = textOpacity;
          ctx.filter = 'drop-shadow(0 0 10px rgba(255, 255, 150, 0.8))';
          ctx.textAlign = "center";
          ctx.fillStyle = "#ffffaa";

          const textX = shiftedCenterX + 350;
          ctx.font = "50px 'Mystery Quest', cursive";
          ctx.fillText("MEET MAGIC", textX, shiftedCenterY - 60);

          ctx.font = "28px 'Mystery Quest', cursive";
          ctx.fillText("The mystical black cat", textX, shiftedCenterY);
          ctx.fillText("who guides seekers to extraordinary gains.", textX, shiftedCenterY + 40);
          ctx.fillText("Hold Magic, and magic will find you.", textX, shiftedCenterY + 90);

          ctx.restore();

          // Desktop-Button einblenden
          beginButtonDesktop.style.opacity = '1';
        }

        requestAnimationFrame(animateDesktop);
      }
      animateDesktop();

      // Bei Resize die Flugbahn anpassen
      window.addEventListener('resize', () => {
        radius = Math.min(canvas.width, canvas.height) * 0.6;
      });
    }
  </script>
</body>
</html>
